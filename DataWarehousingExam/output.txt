----------------PART 1---------------------------
Normalize using z score
mean = 13.958333333333334
standard deviation = 8.204719311559748
Input:
[24, 16, 2, 12, 2, 6, None, 16, 25, 25, 30, None, 33, 19, 24, 23, 13, 6, 16, None, 17, 14, None, 12]
Output:
[1.2238891161723007, 0.24884052569478304, -1.4574945076408727, -0.23868376954397572, -1.4574945076408727, -0.9699702124021139, None, 0.24884052569478304, 1.3457701899819903, 1.3457701899819903, 1.9551755590304385, None, 2.3208187804595077, 0.6144837471238521, 1.2238891161723007, 1.1020080423626109, -0.11680269573428603, -0.9699702124021139, 0.24884052569478304, None, 0.37072159950447275, 0.005078378075403665, None, -0.23868376954397572]

Replace missing values with 50th percentile
Input
[1.2238891161723007, 0.24884052569478304, -1.4574945076408727, -0.23868376954397572, -1.4574945076408727, -0.9699702124021139, None, 0.24884052569478304, 1.3457701899819903, 1.3457701899819903, 1.9551755590304385, None, 2.3208187804595077, 0.6144837471238521, 1.2238891161723007, 1.1020080423626109, -0.11680269573428603, -0.9699702124021139, 0.24884052569478304, None, 0.37072159950447275, 0.005078378075403665, None, -0.23868376954397572]
Sorted data
[-1.4574945076408727, -1.4574945076408727, -0.9699702124021139, -0.9699702124021139, -0.23868376954397572, -0.23868376954397572, -0.11680269573428603, 0.005078378075403665, 0.24884052569478304, 0.24884052569478304, 0.24884052569478304, 0.37072159950447275, 0.6144837471238521, 1.1020080423626109, 1.2238891161723007, 1.2238891161723007, 1.3457701899819903, 1.3457701899819903, 1.9551755590304385, 2.3208187804595077]
Median = 0.24884052569478304
Output
[1.2238891161723007, 0.24884052569478304, -1.4574945076408727, -0.23868376954397572, -1.4574945076408727, -0.9699702124021139, 0.24884052569478304, 0.24884052569478304, 1.3457701899819903, 1.3457701899819903, 1.9551755590304385, 0.24884052569478304, 2.3208187804595077, 0.6144837471238521, 1.2238891161723007, 1.1020080423626109, -0.11680269573428603, -0.9699702124021139, 0.24884052569478304, 0.24884052569478304, 0.37072159950447275, 0.005078378075403665, 0.24884052569478304, -0.23868376954397572]

--------------------PART 2------------------
CREATING DIMENSION TABLES
EXECUTING QUERY
CREATE TABLE state(ID TEXT PRIMARY KEY ,NAME TEXT NOT NULL );
EXECUTING QUERY
CREATE TABLE city(ID TEXT PRIMARY KEY ,NAME TEXT NOT NULL );
CREATING FACT TABLES
EXECUTING QUERY
CREATE TABLE temperature_data(SID TEXT ,CID TEXT ,month TEXT ,temperature INTEGER ,FOREIGN KEY (SID) REFERENCES state(ID) ,FOREIGN KEY (CID) REFERENCES city(ID) );


INSERTING DATA
EXECUTING QUERY
INSERT INTO state(ID,NAME) VALUES ('S1','state_1');
EXECUTING QUERY
INSERT INTO state(ID,NAME) VALUES ('S2','state_2');
EXECUTING QUERY
INSERT INTO city(ID,NAME) VALUES ('C1','city_1_state_1');
EXECUTING QUERY
INSERT INTO city(ID,NAME) VALUES ('C2','city_2_state_1');
EXECUTING QUERY
INSERT INTO city(ID,NAME) VALUES ('C3','city_1_state_2');
EXECUTING QUERY
INSERT INTO city(ID,NAME) VALUES ('C4','city_2_state_2');
EXECUTING QUERY
INSERT INTO city(ID,NAME) VALUES ('C5','city_3_state_2');
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S1','C1','month1',15);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S1','C1','month2',17);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S1','C1','month3',25);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S1','C2','month1',25);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S1','C2','month2',27);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S1','C2','month3',32);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C3','month1',35);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C3','month2',37);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C3','month3',45);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C4','month1',45);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C4','month2',47);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C4','month3',42);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C5','month1',23);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C5','month2',23);
EXECUTING QUERY
INSERT INTO temperature_data(SID,CID,month,temperature) VALUES ('S2','C5','month3',12);
Average temperature of state in summer (month1, month2)
EXECUTING QUERY

    SELECT 
        sid,name,avg(temperature)
    FROM 
        (select sid,temperature,month from temperature_data) 
    INNER JOIN 
        state 
    ON 
        sid=id 
    WHERE
        month 
    IN
        ("month1","month2")
    GROUP BY
        sid;

    
------------------------------------
SID	NAME\Average Temperature
S1	state_1	21.0
S2	state_2	35.0
Average temperature of cities in summer (month1, month2)
EXECUTING QUERY

    SELECT 
        sid,name,avg(temperature)
    FROM 
        (select sid,temperature,month from temperature_data) 
    INNER JOIN 
        state 
    ON 
        sid=id 
    WHERE
        month 
    IN
        ("month1","month2")
    GROUP BY
        sid;

    
------------------------------------
CID	NAME\Average Temperature
S1	state_1	21.0
S2	state_2	35.0
